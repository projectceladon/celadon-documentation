<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thermal Mediation in Celadon &mdash; Documentation for the Celadon Project</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Wireless Connectivity in Celadon" href="wireless-connectivity.html" />
    <link rel="prev" title="Building Intel Platform-Friendly Android Apps" href="build-intel-android-apps.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Celadon Project
          </a>
              <div class="version">
                0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started/getting-started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Guides and Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="tutorials.html#development">Development</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mixins.html">Mixins</a></li>
<li class="toctree-l3"><a class="reference internal" href="enabling-uac3.html">Enabling USB Audio Class 3.0 audio in Celadon</a></li>
<li class="toctree-l3"><a class="reference internal" href="software-debug-tips.html">Software Debugging Tips on Celadon</a></li>
<li class="toctree-l3"><a class="reference internal" href="dbc.html">Making the Android Host Debuggable - ADB for x86 Android Solutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="widevine-integration.html">Widevine* L3 Integration Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="boot-civ-bare-metal.html">Boot CiV on Bare Metal</a></li>
<li class="toctree-l3"><a class="reference internal" href="enabling-sensors-in-celadon.html">Enabling Sensors in Celadon</a></li>
<li class="toctree-l3"><a class="reference internal" href="boot-civ-f2fs.html">Boot CIV with Flash Friendly File System</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrent-camera-access.html">Concurrent Camera Access in CiV</a></li>
<li class="toctree-l3"><a class="reference internal" href="enabling-nnhal-in-celadon.html">Enabling Neural Networks Hardware Abstraction Layer in Celadon</a></li>
<li class="toctree-l3"><a class="reference internal" href="build-intel-android-apps.html">Building Intel Platform-Friendly Android Apps</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Thermal Mediation in Celadon</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-is-a-thermal-daemon">What is a thermal daemon?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#why-is-the-thermal-mediation-solution-required">Why is the thermal mediation solution required?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-enable-thermal-mediation-for-an-android-guest">How to enable thermal mediation for an Android guest?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#validating-thermal-values-in-civ">Validating thermal values in CIV</a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermal-support-in-platform-bios">Thermal Support in Platform BIOS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="wireless-connectivity.html">Wireless Connectivity in Celadon</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorials.html#security">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials.html#system-validation">System Validation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stable-release_iot/stable-release_iot.html">Stable Releases IoT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes/release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faqs.html">Frequently Asked Questions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Celadon Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="tutorials.html">Guides and Tutorials</a></li>
      <li class="breadcrumb-item active">Thermal Mediation in Celadon</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/thermal-mediation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="thermal-mediation-in-celadon">
<span id="thermal-mediation"></span><h1>Thermal Mediation in Celadon</h1>
<section id="what-is-a-thermal-daemon">
<h2>What is a thermal daemon?</h2>
<p>A thermal daemon is used to prevent platforms from overheating. Thermal
daemons monitor the CPU temperature and corrects conditions using
available cooling methods. By default, the thermal daemon monitors the
CPU temperature using available CPU digital temperature sensors and
maintains the CPU temperature, before hardware takes aggressive
correction action.</p>
<p>The thermal daemon looks for thermal sensors and thermal cooling drivers
in the Linux thermal sysfs
(<a class="reference external" href="file:///\sysclassthermal">/sys/class/thermal</a>) and builds a list
of sensors and cooling drivers. Each of the thermal sensors can
optionally be bound to a cooling driver by the in-kernel drivers. In
this case, the Linux kernel thermal core can directly take actions based
on the temperature trip points for each sensor and associated cooling
device. For example, trip temperature X in a sensor can be associated
with cooling driver Y. When the sensor temperature equals X, the cooling
driver Y is activated.</p>
</section>
<section id="why-is-the-thermal-mediation-solution-required">
<h2>Why is the thermal mediation solution required?</h2>
<p>In a virtual environment, guests do not have direct access to read
temperature values from the host machine. To address this issue, the
thermal mediation solution was developed.</p>
<p>The architectural diagram of thermal mediation is shown in Figure 1:</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../_images/cs004-thermal-mediation-architecture.png"><img alt="../_images/cs004-thermal-mediation-architecture.png" src="../_images/cs004-thermal-mediation-architecture.png" style="width: 6.10877in; height: 4.16146in;" /></a>
<figcaption>
<p><span class="caption-text">Figure 1: Thermal Mediation Architecture</span></p>
</figcaption>
</figure>
<ul>
<li><p><strong>thermal HAL-VirtIO VSOCK client.</strong> The thermal HAL-VirtIO VSOCK
client is a customized version of the thermal HAL. It helps
connect, read, and transfer thermal values to the Android framework
from the <strong>thermal VirtIO VSOCK utility</strong> running on the host.</p></li>
<li><p><strong>thermal VirtIO VSOCK utility.</strong> The thermal VirtIO VSOCK utility
helps read values from the thermal zone and transfer to the
<strong>thermal HAL-VirtIO VSOCK client.</strong></p></li>
<li><p><strong>thermald configuration XML.</strong> The thermal daemon allows you to
change this relationship or add a new one via a thermal
configuration file (<code class="file docutils literal notranslate"><span class="pre">thermal-conf.xml</span></code>)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more details on thermal configuration XML, refer to
<a class="reference external" href="https://manpages.ubuntu.com/manpages/bionic/man5/thermal-conf.xml.5.html">thermal-conf.xml</a></p>
</div>
</li>
</ul>
</section>
<section id="how-to-enable-thermal-mediation-for-an-android-guest">
<h2>How to enable thermal mediation for an Android guest?</h2>
<p>To use thermal mediation, configure the <code class="file docutils literal notranslate"><span class="pre">.ini</span></code> file of the guest.</p>
<ul>
<li><p><strong>Path.</strong></p>
<p><code class="file docutils literal notranslate"><span class="pre">&lt;home</span> <span class="pre">path&gt;/.intel/.civ/&lt;guest</span> <span class="pre">ini</span> <span class="pre">file&gt;</span></code></p>
</li>
<li><p><strong>Configuration.</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>mediation<span class="o">]</span>

<span class="nv">thermal_med</span> <span class="o">=</span>&lt;path of thermsys&gt;

ex: <span class="nv">thermal_med</span><span class="o">=</span>/home/intel/civ/scripts/thermsys
</pre></div>
</div>
</li>
</ul>
</section>
<section id="validating-thermal-values-in-civ">
<h2>Validating thermal values in CIV</h2>
<p>To validate the thermal values in CIV, use this command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>adb shell dumpsys thermalservice
</pre></div>
</div>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/cs004-results-adb-shell-dumpsys.png"><img alt="../_images/cs004-results-adb-shell-dumpsys.png" src="../_images/cs004-results-adb-shell-dumpsys.png" style="width: 5.00000in; height: 3.20833in;" /></a>
</figure>
</section>
<section id="thermal-support-in-platform-bios">
<h2>Thermal Support in Platform BIOS</h2>
<p>In PC-like platforms, the HW is booted initially with BIOS FW. BIOS
FW boots and loads the OS for user operations. The BIOS in modern
PCs is implemented using UEFI (unified extensible firmware
interface) and supports ACPI (advanced configuration and power
interface). ACPI passes all the system information to the OS by
means of ACPI tables. The ACPI specification are at
<a class="reference external" href="https://uefi.org/htmlspecs/ACPI_Spec_6_4_html/index.html">https://uefi.org/htmlspecs/ACPI_Spec_6_4_html/index.html</a></p>
<p>ACPI defines interfaces that allow OSPM to be proactive in its
system cooling policies. With operating system power management
(OSPM) in control of the operating environment, cooling decisions
can be made based on the system’s application load, the user’s
preference towards performance or energy conservation, and thermal
heuristics. Graceful shutdown of devices or the entire system at
critical heat levels also becomes possible.</p>
<p>It supports thermal zones, cooling policies, fan devices, and
thermal objects for managing the system. <strong>Please ensure that the
platform UEFI/BIOS supports the following thermal objects and
interfaces</strong>:</p>
<p>Fan Devices:
<a class="reference external" href="https://uefi.org/htmlspecs/ACPI_Spec_6_4_html/11_Thermal_Management/fan-device.html%20">https://uefi.org/htmlspecs/ACPI_Spec_6_4_html/11_Thermal_Management/fan-device.html</a></p>
<p>Thermal Objects:
<a class="reference external" href="https://uefi.org/htmlspecs/ACPI_Spec_6_4_html/11_Thermal_Management/thermal-objects.html">https://uefi.org/htmlspecs/ACPI_Spec_6_4_html/11_Thermal_Management/thermal-objects.html</a></p>
<p>Detailed examples of implementation is provided here:
<a class="reference external" href="https://uefi.org/htmlspecs/ACPI_Spec_6_4_html/11_Thermal_Management/thermal-zone-examples.html">https://uefi.org/htmlspecs/ACPI_Spec_6_4_html/11_Thermal_Management/thermal-zone-examples.html</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="build-intel-android-apps.html" class="btn btn-neutral float-left" title="Building Intel Platform-Friendly Android Apps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="wireless-connectivity.html" class="btn btn-neutral float-right" title="Wireless Connectivity in Celadon" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, BSD, MIT, Apache and GPL licenses.
      <span class="lastupdated">Last updated on Nov 05, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>